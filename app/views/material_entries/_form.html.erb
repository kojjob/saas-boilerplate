<%= form_with model: material_entry, class: "space-y-5" do |f| %>
  <% if material_entry.errors.any? %>
    <div class="rounded-lg bg-red-50 p-4 text-sm text-red-700">
      <ul class="list-disc pl-5 space-y-1">
        <% material_entry.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%# Material details Section %>
  <div class="space-y-4">
    <h3 class="text-sm font-medium text-gray-900">Material details</h3>

    <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">Project</label>
      <%= f.collection_select :project_id, @projects, :id, :name,
          { prompt: "Select a project" },
          class: "w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white" %>
    </div>

    <div class="grid grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Date</label>
        <%= f.date_field :date,
            class: "w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent" %>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Item name</label>
        <%= f.text_field :name,
            class: "w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",
            placeholder: "e.g., Copper pipe 1/2\"" %>
      </div>
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">Description <span class="text-gray-400 font-normal">(optional)</span></label>
      <%= f.text_area :description,
          rows: 2,
          class: "w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none",
          placeholder: "Additional details about the material..." %>
    </div>
  </div>

  <%# Quantity & Pricing Section %>
  <div class="space-y-4 pt-4 border-t border-gray-100">
    <h3 class="text-sm font-medium text-gray-900">Quantity & Pricing</h3>

    <div class="grid grid-cols-3 gap-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Quantity</label>
        <%= f.number_field :quantity,
            step: 0.01,
            min: 0,
            class: "w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",
            placeholder: "1" %>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Unit</label>
        <%= f.text_field :unit,
            class: "w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",
            placeholder: "e.g., ft, ea, lb" %>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Unit cost</label>
        <div class="relative">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <span class="text-gray-400 text-sm">$</span>
          </div>
          <%= f.number_field :unit_cost,
              step: 0.01,
              min: 0,
              class: "w-full pl-7 pr-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",
              placeholder: "0.00" %>
        </div>
      </div>
    </div>
  </div>

  <%# Billing Section %>
  <div class="space-y-4 pt-4 border-t border-gray-100">
    <h3 class="text-sm font-medium text-gray-900">Billing</h3>

    <div class="flex items-center gap-3">
      <%= f.check_box :billable,
          class: "h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded" %>
      <label class="text-sm text-gray-700">
        This material is billable to client
      </label>
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">Markup percentage <span class="text-gray-400 font-normal">(optional)</span></label>
      <div class="relative w-32">
        <%= f.number_field :markup_percentage,
            step: 0.1,
            min: 0,
            max: 100,
            class: "w-full px-3 py-2 pr-8 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",
            placeholder: "0" %>
        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
          <span class="text-gray-400 text-sm">%</span>
        </div>
      </div>
      <p class="mt-1 text-xs text-gray-500">Add a markup percentage to the material cost</p>
    </div>
  </div>

  <%# Footer with actions %>
  <div class="flex items-center justify-end gap-3 pt-4 border-t border-gray-100">
    <button type="button"
            data-action="modal#close"
            class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
      Cancel
    </button>
    <%= f.submit material_entry.persisted? ? "Save changes" : "Add material",
        class: "px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors cursor-pointer" %>
  </div>
<% end %>
