<% content_for :page_title, "Clients" %>

<div class="space-y-8">
  <%# Hero Header Section %>
  <div class="relative overflow-hidden bg-gradient-to-r from-slate-900 via-slate-800 to-slate-900 rounded-2xl shadow-2xl">
    <%# Decorative pattern %>
    <div class="absolute inset-0 opacity-10">
      <svg class="w-full h-full" viewBox="0 0 100 100" preserveAspectRatio="none">
        <defs>
          <pattern id="clients-grid" width="10" height="10" patternUnits="userSpaceOnUse">
            <path d="M 10 0 L 0 0 0 10" fill="none" stroke="currentColor" stroke-width="0.5"/>
          </pattern>
        </defs>
        <rect width="100%" height="100%" fill="url(#clients-grid)"/>
      </svg>
    </div>

    <%# Gradient orbs %>
    <div class="absolute top-0 right-0 w-72 h-72 bg-emerald-500/20 rounded-full blur-3xl"></div>
    <div class="absolute bottom-0 left-0 w-48 h-48 bg-teal-500/20 rounded-full blur-3xl"></div>

    <div class="relative px-8 py-8">
      <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6">
        <div class="flex items-center gap-4">
          <div class="w-14 h-14 rounded-2xl bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center shadow-lg shadow-emerald-500/30">
            <svg class="w-7 h-7 text-white" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z" />
            </svg>
          </div>
          <div>
            <h1 class="text-2xl font-bold text-white tracking-tight">Clients</h1>
            <p class="text-slate-400">Manage your client relationships</p>
          </div>
        </div>

        <div class="flex items-center gap-3">
          <div class="hidden sm:flex items-center gap-4 mr-4">
            <div class="text-center">
              <p class="text-2xl font-bold text-white"><%= @clients.respond_to?(:total_count) ? @clients.total_count : @clients.count %></p>
              <p class="text-xs text-slate-400">Total Clients</p>
            </div>
            <div class="w-px h-10 bg-white/20"></div>
            <div class="text-center">
              <p class="text-2xl font-bold text-emerald-400"><%= @clients.respond_to?(:select) ? @clients.select { |c| c.respond_to?(:status) && c.status == 'active' }.count : 0 %></p>
              <p class="text-xs text-slate-400">Active</p>
            </div>
          </div>
          <%= link_to new_client_path, data: { turbo_frame: "modal" }, class: "inline-flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-emerald-500 to-teal-600 text-white text-sm font-semibold rounded-xl hover:from-emerald-600 hover:to-teal-700 transition-all shadow-lg shadow-emerald-500/30 hover:shadow-emerald-500/50" do %>
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
            </svg>
            Add Client
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <%# Search and filters %>
  <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-5">
    <%= form_with url: clients_path, method: :get, local: true, class: "flex flex-col sm:flex-row gap-4" do |f| %>
      <div class="flex-1">
        <div class="relative">
          <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
            <svg class="w-5 h-5 text-slate-400" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
            </svg>
          </div>
          <%= f.text_field :search, value: params[:search], placeholder: "Search clients by name, company, or email...", class: "w-full pl-11 pr-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 text-sm bg-slate-50 focus:bg-white transition-colors" %>
        </div>
      </div>
      <div class="flex items-center gap-2">
        <%= f.submit "Search", class: "px-5 py-3 bg-slate-900 text-white text-sm font-medium rounded-xl hover:bg-slate-800 transition-colors cursor-pointer" %>
        <% if params[:search].present? %>
          <%= link_to clients_path, class: "px-5 py-3 text-slate-600 text-sm font-medium hover:text-slate-900 border border-slate-200 rounded-xl hover:bg-slate-50 transition-colors" do %>
            Clear
          <% end %>
        <% end %>
      </div>
    <% end %>
  </div>

  <%# Clients Grid/List %>
  <% if @clients.any? %>
    <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-5">
      <% @clients.each do |client| %>
        <%= link_to client_path(client), class: "group block" do %>
          <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 hover:shadow-xl hover:shadow-emerald-500/10 hover:border-emerald-200 transition-all duration-300">
            <div class="flex items-start gap-4">
              <%# Avatar %>
              <div class="w-14 h-14 rounded-xl bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center shadow-lg shadow-emerald-500/25 group-hover:scale-110 transition-transform duration-300">
                <span class="text-xl font-bold text-white"><%= client.name.first.upcase %></span>
              </div>

              <%# Client Info %>
              <div class="flex-1 min-w-0">
                <div class="flex items-start justify-between gap-2">
                  <div>
                    <h3 class="text-lg font-semibold text-slate-900 group-hover:text-emerald-600 transition-colors truncate">
                      <%= client.name %>
                    </h3>
                    <% if client.company.present? %>
                      <p class="text-sm text-slate-500 truncate"><%= client.company %></p>
                    <% end %>
                  </div>
                  <% if client.respond_to?(:status) && client.status.present? %>
                    <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium <%= client.status == 'active' ? 'bg-emerald-100 text-emerald-700' : 'bg-slate-100 text-slate-600' %>">
                      <%= client.status.humanize %>
                    </span>
                  <% end %>
                </div>

                <%# Contact Info %>
                <div class="mt-3 space-y-1">
                  <% if client.email.present? %>
                    <div class="flex items-center gap-2 text-sm text-slate-500">
                      <svg class="w-4 h-4 text-slate-400" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" />
                      </svg>
                      <span class="truncate"><%= client.email %></span>
                    </div>
                  <% end %>
                  <% if client.phone.present? %>
                    <div class="flex items-center gap-2 text-sm text-slate-500">
                      <svg class="w-4 h-4 text-slate-400" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z" />
                      </svg>
                      <span><%= client.phone %></span>
                    </div>
                  <% end %>
                </div>
              </div>
            </div>

            <%# Stats Row %>
            <div class="mt-5 pt-5 border-t border-slate-100 flex items-center justify-between">
              <div class="flex items-center gap-4">
                <div class="flex items-center gap-1.5">
                  <div class="w-6 h-6 rounded-lg bg-blue-100 flex items-center justify-center">
                    <svg class="w-3.5 h-3.5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12.75V12A2.25 2.25 0 014.5 9.75h15A2.25 2.25 0 0121.75 12v.75m-8.69-6.44l-2.12-2.12a1.5 1.5 0 00-1.061-.44H4.5A2.25 2.25 0 002.25 6v12a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9a2.25 2.25 0 00-2.25-2.25h-5.379a1.5 1.5 0 01-1.06-.44z" />
                    </svg>
                  </div>
                  <span class="text-sm font-medium text-slate-700"><%= client.projects.count %></span>
                  <span class="text-xs text-slate-400">projects</span>
                </div>

                <div class="flex items-center gap-1.5">
                  <div class="w-6 h-6 rounded-lg bg-purple-100 flex items-center justify-center">
                    <svg class="w-3.5 h-3.5 text-purple-600" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                    </svg>
                  </div>
                  <span class="text-sm font-medium text-slate-700"><%= client.invoices.count %></span>
                  <span class="text-xs text-slate-400">invoices</span>
                </div>
              </div>

              <div class="flex items-center gap-1 text-emerald-600 opacity-0 group-hover:opacity-100 transition-opacity">
                <span class="text-xs font-medium">View</span>
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
                </svg>
              </div>
            </div>

            <%# Added Date %>
            <div class="mt-3 flex items-center gap-1 text-xs text-slate-400">
              <svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              Added <%= time_ago_in_words(client.created_at) %> ago
            </div>
          </div>
        <% end %>
      <% end %>
    </div>

    <%# Pagination %>
    <% if @clients.respond_to?(:total_pages) && @clients.total_pages > 1 %>
      <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-4">
        <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
          <p class="text-sm text-slate-500">
            Showing <span class="font-medium text-slate-700"><%= @clients.offset_value + 1 %></span> to <span class="font-medium text-slate-700"><%= [@clients.offset_value + @clients.length, @clients.total_count].min %></span> of <span class="font-medium text-slate-700"><%= @clients.total_count %></span> clients
          </p>
          <div class="flex items-center gap-2">
            <% if @clients.prev_page %>
              <%= link_to clients_path(page: @clients.prev_page, search: params[:search]), class: "inline-flex items-center gap-1 px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-200 rounded-xl hover:bg-slate-50 transition-colors" do %>
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
                </svg>
                Previous
              <% end %>
            <% end %>
            <% if @clients.next_page %>
              <%= link_to clients_path(page: @clients.next_page, search: params[:search]), class: "inline-flex items-center gap-1 px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-200 rounded-xl hover:bg-slate-50 transition-colors" do %>
                Next
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
                </svg>
              <% end %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  <% else %>
    <%# Empty State %>
    <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-12">
      <div class="text-center max-w-md mx-auto">
        <div class="w-20 h-20 rounded-2xl bg-gradient-to-br from-emerald-100 to-teal-100 flex items-center justify-center mx-auto mb-6">
          <svg class="w-10 h-10 text-emerald-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z" />
          </svg>
        </div>
        <h3 class="text-xl font-semibold text-slate-900 mb-2">No clients yet</h3>
        <p class="text-slate-500 mb-6">
          <% if params[:search].present? %>
            No clients match your search. Try a different search term.
          <% else %>
            Get started by adding your first client. Build your client base and grow your business.
          <% end %>
        </p>
        <% if params[:search].present? %>
          <%= link_to clients_path, class: "inline-flex items-center gap-2 px-5 py-2.5 text-sm font-medium text-slate-700 bg-white border border-slate-200 rounded-xl hover:bg-slate-50 transition-colors" do %>
            Clear Search
          <% end %>
        <% else %>
          <%= link_to new_client_path, data: { turbo_frame: "modal" }, class: "inline-flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-emerald-500 to-teal-600 text-white text-sm font-semibold rounded-xl hover:from-emerald-600 hover:to-teal-700 transition-all shadow-lg shadow-emerald-500/30" do %>
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
            </svg>
            Add Your First Client
          <% end %>
        <% end %>
      </div>
    </div>
  <% end %>
</div>

<%# Modal container %>
<%= turbo_frame_tag "modal" %>
