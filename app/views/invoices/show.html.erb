<% content_for :page_title, "Invoice #{@invoice.invoice_number}" %>

<div class="max-w-7xl mx-auto space-y-6">
  <%# Floating Sticky Header %>
  <div class="sticky top-0 z-10 bg-white/95 backdrop-blur-sm rounded-xl shadow-sm border border-slate-200 p-4 mb-6">
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
      <div class="flex items-center gap-4">
        <%= link_to invoices_path, class: "p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors" do %>
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
        <% end %>

        <%# Invoice Icon with Status Color %>
        <% status_colors = {
          draft: "from-slate-400 to-slate-500",
          sent: "from-blue-500 to-indigo-600",
          viewed: "from-indigo-500 to-purple-600",
          paid: "from-emerald-500 to-teal-600",
          overdue: "from-red-500 to-rose-600",
          cancelled: "from-slate-400 to-slate-500"
        } %>
        <div class="flex-shrink-0 w-14 h-14 rounded-xl bg-gradient-to-br <%= status_colors[@invoice.status.to_sym] %> flex items-center justify-center shadow-md">
          <svg class="w-7 h-7 text-white" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
          </svg>
        </div>

        <div>
          <div class="flex items-center gap-3">
            <h1 class="text-2xl font-bold text-slate-900"><%= @invoice.invoice_number %></h1>
            <% status_styles = {
              draft: { bg: "bg-slate-100", text: "text-slate-600", dot: "bg-slate-400" },
              sent: { bg: "bg-blue-50", text: "text-blue-700", dot: "bg-blue-500" },
              viewed: { bg: "bg-indigo-50", text: "text-indigo-700", dot: "bg-indigo-500" },
              paid: { bg: "bg-emerald-50", text: "text-emerald-700", dot: "bg-emerald-500" },
              overdue: { bg: "bg-red-50", text: "text-red-700", dot: "bg-red-500" },
              cancelled: { bg: "bg-slate-100", text: "text-slate-500", dot: "bg-slate-400" }
            } %>
            <% style = status_styles[@invoice.status.to_sym] %>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium <%= style[:bg] %> <%= style[:text] %>">
              <span class="w-1.5 h-1.5 rounded-full mr-1.5 <%= style[:dot] %>"></span>
              <%= @invoice.status.humanize %>
            </span>
          </div>
          <p class="text-sm text-slate-500"><%= @invoice.client.name %><%= " â€¢ #{@invoice.client.company}" if @invoice.client.company.present? %></p>
        </div>
      </div>

      <div class="flex items-center gap-2 flex-wrap">
        <%# Quick Action Icons %>
        <div class="hidden sm:flex items-center gap-1 mr-2">
          <%= link_to preview_invoice_path(@invoice), target: "_blank", class: "p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors", title: "Preview" do %>
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.64 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.64 0-8.573-3.007-9.963-7.178z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
          <% end %>
          <%= link_to download_invoice_path(@invoice), class: "p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors", title: "Download PDF" do %>
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" />
            </svg>
          <% end %>
          <button type="button" onclick="window.print()" class="p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors" title="Print">
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0110.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0l.229 2.523a1.125 1.125 0 01-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0021 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 00-1.913-.247M6.34 18H5.25A2.25 2.25 0 013 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 011.913-.247m10.5 0a48.536 48.536 0 00-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5zm-3 0h.008v.008H15V10.5z" />
            </svg>
          </button>
        </div>

        <%# Action Buttons %>
        <% if @invoice.draft? %>
          <%= link_to edit_invoice_path(@invoice), data: { turbo_frame: "modal" }, class: "inline-flex items-center px-3 py-2 border border-slate-300 text-sm font-medium rounded-lg text-slate-700 bg-white hover:bg-slate-50 transition-colors" do %>
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
            </svg>
            Edit
          <% end %>
          <%= button_to send_invoice_invoice_path(@invoice), method: :patch, class: "inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white text-sm font-medium rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all shadow-sm", form: { data: { turbo_confirm: "Send this invoice to #{@invoice.client.name}?" } } do %>
            <svg class="w-4 h-4 mr-2" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" />
            </svg>
            Send Invoice
          <% end %>
        <% end %>

        <% if @invoice.unpaid? %>
          <%= button_to mark_paid_invoice_path(@invoice), method: :patch, class: "inline-flex items-center px-4 py-2 bg-gradient-to-r from-emerald-500 to-teal-600 text-white text-sm font-medium rounded-lg hover:from-emerald-600 hover:to-teal-700 transition-all shadow-sm", form: { data: { turbo_confirm: "Mark this invoice as paid?" } } do %>
            <svg class="w-4 h-4 mr-2" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            Mark Paid
          <% end %>
        <% end %>

        <%# More Actions Dropdown %>
        <div class="relative" data-controller="dropdown">
          <button type="button" data-action="dropdown#toggle" class="p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors">
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 12.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 18.75a.75.75 0 110-1.5.75.75 0 010 1.5z" />
            </svg>
          </button>
          <div data-dropdown-target="menu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg border border-slate-200 py-1 z-20">
            <% if !@invoice.paid? && !@invoice.cancelled? %>
              <%= button_to mark_cancelled_invoice_path(@invoice), method: :patch, class: "flex items-center gap-2 w-full px-4 py-2 text-sm text-slate-700 hover:bg-slate-50", form: { data: { turbo_confirm: "Cancel this invoice?" } } do %>
                <svg class="w-4 h-4 text-slate-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" />
                </svg>
                Cancel Invoice
              <% end %>
            <% end %>
            <% if @invoice.draft? || @invoice.cancelled? %>
              <%= button_to invoice_path(@invoice), method: :delete, class: "flex items-center gap-2 w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50", form: { data: { turbo_confirm: "Delete this invoice permanently?" } } do %>
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />
                </svg>
                Delete Invoice
              <% end %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <%# Alert Banner for Overdue %>
  <% if @invoice.past_due? && !@invoice.paid? && !@invoice.cancelled? %>
    <div class="p-4 bg-gradient-to-r from-red-50 to-orange-50 border border-red-200 rounded-xl">
      <div class="flex items-center gap-3">
        <div class="flex-shrink-0 w-10 h-10 bg-red-100 rounded-full flex items-center justify-center">
          <svg class="w-5 h-5 text-red-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
          </svg>
        </div>
        <div class="flex-1">
          <h3 class="text-sm font-semibold text-red-800">Payment Overdue</h3>
          <p class="text-sm text-red-700">This invoice is <%= @invoice.days_overdue %> days past due. Consider sending a reminder.</p>
        </div>
        <button type="button" class="px-4 py-2 text-sm font-medium text-red-700 bg-white border border-red-300 rounded-lg hover:bg-red-50 transition-colors">
          Send Reminder
        </button>
      </div>
    </div>
  <% end %>

  <%# Financial Stats Cards %>
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
    <%# Total Amount %>
    <div class="bg-gradient-to-br from-emerald-500 to-teal-600 rounded-xl p-5 text-white shadow-lg">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-emerald-100 text-sm font-medium">Total Amount</p>
          <p class="text-2xl font-bold mt-1"><%= number_to_currency(@invoice.total_amount) %></p>
          <p class="text-emerald-100 text-xs mt-1"><%= @invoice.line_items.count %> line item<%= @invoice.line_items.count != 1 ? 's' : '' %></p>
        </div>
        <div class="w-12 h-12 rounded-full bg-white/20 flex items-center justify-center">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </div>
      </div>
    </div>

    <%# Due Date / Payment Status %>
    <% if @invoice.paid? %>
      <div class="bg-gradient-to-br from-emerald-400 to-green-500 rounded-xl p-5 text-white shadow-lg">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-emerald-100 text-sm font-medium">Payment Received</p>
            <p class="text-2xl font-bold mt-1"><%= @invoice.paid_at&.strftime("%b %d") || "Paid" %></p>
            <p class="text-emerald-100 text-xs mt-1"><%= @invoice.payment_method&.humanize || "Payment recorded" %></p>
          </div>
          <div class="w-12 h-12 rounded-full bg-white/20 flex items-center justify-center">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
        </div>
      </div>
    <% elsif @invoice.past_due? %>
      <div class="bg-gradient-to-br from-red-500 to-rose-600 rounded-xl p-5 text-white shadow-lg">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-red-100 text-sm font-medium">Days Overdue</p>
            <p class="text-2xl font-bold mt-1"><%= @invoice.days_overdue %></p>
            <p class="text-red-100 text-xs mt-1">Due <%= @invoice.due_date.strftime("%b %d, %Y") %></p>
          </div>
          <div class="w-12 h-12 rounded-full bg-white/20 flex items-center justify-center">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
            </svg>
          </div>
        </div>
      </div>
    <% else %>
      <div class="bg-gradient-to-br from-amber-500 to-orange-600 rounded-xl p-5 text-white shadow-lg">
        <div class="flex items-center justify-between">
          <div>
            <p class="text-amber-100 text-sm font-medium">Due In</p>
            <p class="text-2xl font-bold mt-1"><%= @invoice.days_until_due %> days</p>
            <p class="text-amber-100 text-xs mt-1">Due <%= @invoice.due_date.strftime("%b %d, %Y") %></p>
          </div>
          <div class="w-12 h-12 rounded-full bg-white/20 flex items-center justify-center">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
        </div>
      </div>
    <% end %>

    <%# Tax Amount %>
    <div class="bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl p-5 text-white shadow-lg">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-indigo-100 text-sm font-medium">Tax <%= @invoice.tax_rate && @invoice.tax_rate > 0 ? "(#{number_with_precision(@invoice.tax_rate, precision: 1, strip_insignificant_zeros: true)}%)" : "" %></p>
          <p class="text-2xl font-bold mt-1"><%= number_to_currency(@invoice.tax_amount || 0) %></p>
          <p class="text-indigo-100 text-xs mt-1">Subtotal: <%= number_to_currency(@invoice.subtotal) %></p>
        </div>
        <div class="w-12 h-12 rounded-full bg-white/20 flex items-center justify-center">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
          </svg>
        </div>
      </div>
    </div>

    <%# Issue Date %>
    <div class="bg-gradient-to-br from-slate-600 to-slate-700 rounded-xl p-5 text-white shadow-lg">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-slate-300 text-sm font-medium">Issue Date</p>
          <p class="text-2xl font-bold mt-1"><%= @invoice.issue_date.strftime("%b %d") %></p>
          <p class="text-slate-300 text-xs mt-1"><%= @invoice.issue_date.strftime("%Y") %></p>
        </div>
        <div class="w-12 h-12 rounded-full bg-white/20 flex items-center justify-center">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
        </div>
      </div>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <%# Left Column: Client & Invoice Details %>
    <div class="lg:col-span-1 space-y-6">
      <%# Client Card %>
      <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
        <div class="px-6 py-4 bg-gradient-to-r from-indigo-50 to-purple-50 border-b border-slate-200">
          <div class="flex items-center gap-2">
            <svg class="w-5 h-5 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
            </svg>
            <h2 class="text-base font-semibold text-slate-900">Bill To</h2>
          </div>
        </div>
        <div class="p-6">
          <div class="flex items-center gap-4 mb-4">
            <div class="w-14 h-14 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center text-white text-xl font-bold shadow-lg shadow-indigo-500/30">
              <%= @invoice.client.name[0..1].upcase %>
            </div>
            <div class="flex-1 min-w-0">
              <p class="font-semibold text-slate-900 truncate"><%= @invoice.client.name %></p>
              <% if @invoice.client.company.present? %>
                <p class="text-sm text-slate-500 truncate"><%= @invoice.client.company %></p>
              <% end %>
            </div>
          </div>

          <div class="space-y-3">
            <% if @invoice.client.email.present? %>
              <a href="mailto:<%= @invoice.client.email %>" class="flex items-center gap-3 text-sm text-slate-600 hover:text-indigo-600 transition-colors">
                <div class="w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center">
                  <svg class="w-4 h-4 text-slate-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" />
                  </svg>
                </div>
                <span class="truncate"><%= @invoice.client.email %></span>
              </a>
            <% end %>
            <% if @invoice.client.phone.present? %>
              <a href="tel:<%= @invoice.client.phone %>" class="flex items-center gap-3 text-sm text-slate-600 hover:text-indigo-600 transition-colors">
                <div class="w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center">
                  <svg class="w-4 h-4 text-slate-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z" />
                  </svg>
                </div>
                <span><%= @invoice.client.phone %></span>
              </a>
            <% end %>
            <% if @invoice.client.address_line1.present? %>
              <div class="flex items-start gap-3 text-sm text-slate-600">
                <div class="w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center flex-shrink-0">
                  <svg class="w-4 h-4 text-slate-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" />
                  </svg>
                </div>
                <div>
                  <p><%= @invoice.client.address_line1 %></p>
                  <% if @invoice.client.address_line2.present? %>
                    <p><%= @invoice.client.address_line2 %></p>
                  <% end %>
                  <% if @invoice.client.city.present? || @invoice.client.state.present? %>
                    <p><%= [@invoice.client.city, @invoice.client.state].compact.join(", ") %> <%= @invoice.client.postal_code %></p>
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>

          <div class="mt-4 pt-4 border-t border-slate-100">
            <%= link_to client_path(@invoice.client), class: "inline-flex items-center gap-2 text-sm font-medium text-indigo-600 hover:text-indigo-700 transition-colors" do %>
              View Client Profile
              <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
              </svg>
            <% end %>
          </div>
        </div>
      </div>

      <%# Project Card %>
      <% if @invoice.project.present? %>
        <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
          <div class="px-6 py-4 bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-slate-200">
            <div class="flex items-center gap-2">
              <svg class="w-5 h-5 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
              </svg>
              <h2 class="text-base font-semibold text-slate-900">Related Project</h2>
            </div>
          </div>
          <div class="p-6">
            <div class="flex items-center gap-4">
              <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-md">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
                </svg>
              </div>
              <div class="flex-1 min-w-0">
                <%= link_to @invoice.project.name, project_path(@invoice.project), class: "font-semibold text-slate-900 hover:text-indigo-600 transition-colors truncate block" %>
                <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium <%= project_status_class(@invoice.project.status) %> mt-1">
                  <%= @invoice.project.status&.humanize || "Draft" %>
                </span>
              </div>
            </div>
          </div>
        </div>
      <% end %>

      <%# Activity Timeline %>
      <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
        <div class="px-6 py-4 bg-gradient-to-r from-slate-50 to-slate-100 border-b border-slate-200">
          <div class="flex items-center gap-2">
            <svg class="w-5 h-5 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <h2 class="text-base font-semibold text-slate-900">Activity</h2>
          </div>
        </div>
        <div class="p-6">
          <div class="relative">
            <div class="absolute left-4 top-0 bottom-0 w-px bg-slate-200"></div>

            <div class="space-y-6">
              <%# Created %>
              <div class="flex gap-4">
                <div class="relative">
                  <div class="w-8 h-8 bg-slate-100 rounded-full flex items-center justify-center z-10 relative">
                    <svg class="w-4 h-4 text-slate-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                    </svg>
                  </div>
                </div>
                <div class="flex-1 pb-0">
                  <p class="text-sm font-medium text-slate-900">Invoice Created</p>
                  <p class="text-xs text-slate-500"><%= @invoice.created_at.strftime("%b %d, %Y at %I:%M %p") %></p>
                </div>
              </div>

              <% if @invoice.sent_at.present? %>
                <div class="flex gap-4">
                  <div class="relative">
                    <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center z-10 relative">
                      <svg class="w-4 h-4 text-blue-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" />
                      </svg>
                    </div>
                  </div>
                  <div class="flex-1 pb-0">
                    <p class="text-sm font-medium text-slate-900">Invoice Sent</p>
                    <p class="text-xs text-slate-500"><%= @invoice.sent_at.strftime("%b %d, %Y at %I:%M %p") %></p>
                  </div>
                </div>
              <% end %>

              <% if @invoice.paid_at.present? %>
                <div class="flex gap-4">
                  <div class="relative">
                    <div class="w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center z-10 relative">
                      <svg class="w-4 h-4 text-emerald-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                      </svg>
                    </div>
                  </div>
                  <div class="flex-1 pb-0">
                    <p class="text-sm font-medium text-slate-900">Payment Received</p>
                    <p class="text-xs text-slate-500"><%= @invoice.paid_at.strftime("%b %d, %Y at %I:%M %p") %></p>
                  </div>
                </div>
              <% end %>

              <% if @invoice.cancelled? %>
                <div class="flex gap-4">
                  <div class="relative">
                    <div class="w-8 h-8 bg-slate-100 rounded-full flex items-center justify-center z-10 relative">
                      <svg class="w-4 h-4 text-slate-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" />
                      </svg>
                    </div>
                  </div>
                  <div class="flex-1 pb-0">
                    <p class="text-sm font-medium text-slate-900">Invoice Cancelled</p>
                    <p class="text-xs text-slate-500"><%= @invoice.updated_at.strftime("%b %d, %Y at %I:%M %p") %></p>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>

      <%# Quick Actions Card %>
      <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
        <div class="px-6 py-4 bg-gradient-to-r from-slate-50 to-slate-100 border-b border-slate-200">
          <div class="flex items-center gap-2">
            <svg class="w-5 h-5 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
            </svg>
            <h2 class="text-base font-semibold text-slate-900">Quick Actions</h2>
          </div>
        </div>
        <div class="p-4 space-y-2">
          <%= link_to preview_invoice_path(@invoice), target: "_blank", class: "flex items-center gap-3 w-full px-4 py-3 rounded-lg hover:bg-slate-50 transition-colors group" do %>
            <div class="w-9 h-9 rounded-lg bg-blue-100 flex items-center justify-center group-hover:bg-blue-200 transition-colors">
              <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
              </svg>
            </div>
            <div class="flex-1">
              <p class="text-sm font-medium text-slate-900">Preview Invoice</p>
              <p class="text-xs text-slate-500">View as your client sees it</p>
            </div>
            <svg class="w-5 h-5 text-slate-400 group-hover:text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          <% end %>

          <%= link_to download_invoice_path(@invoice), class: "flex items-center gap-3 w-full px-4 py-3 rounded-lg hover:bg-slate-50 transition-colors group" do %>
            <div class="w-9 h-9 rounded-lg bg-emerald-100 flex items-center justify-center group-hover:bg-emerald-200 transition-colors">
              <svg class="w-4 h-4 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
              </svg>
            </div>
            <div class="flex-1">
              <p class="text-sm font-medium text-slate-900">Download PDF</p>
              <p class="text-xs text-slate-500">Save a copy for your records</p>
            </div>
            <svg class="w-5 h-5 text-slate-400 group-hover:text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          <% end %>

          <%= link_to new_invoice_path(client_id: @invoice.client.id), data: { turbo_frame: "modal" }, class: "flex items-center gap-3 w-full px-4 py-3 rounded-lg hover:bg-slate-50 transition-colors group" do %>
            <div class="w-9 h-9 rounded-lg bg-indigo-100 flex items-center justify-center group-hover:bg-indigo-200 transition-colors">
              <svg class="w-4 h-4 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
              </svg>
            </div>
            <div class="flex-1">
              <p class="text-sm font-medium text-slate-900">New Invoice</p>
              <p class="text-xs text-slate-500">Create another for this client</p>
            </div>
            <svg class="w-5 h-5 text-slate-400 group-hover:text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          <% end %>
        </div>
      </div>
    </div>

    <%# Right Column: Invoice Document %>
    <div class="lg:col-span-2 space-y-6">
      <%# Line Items Card %>
      <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
        <div class="px-6 py-4 bg-gradient-to-r from-emerald-50 to-teal-50 border-b border-slate-200 flex items-center justify-between">
          <div class="flex items-center gap-2">
            <svg class="w-5 h-5 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
            </svg>
            <h2 class="text-base font-semibold text-slate-900">Line Items</h2>
            <span class="ml-2 px-2 py-0.5 rounded-full bg-emerald-100 text-emerald-600 text-xs font-medium"><%= @invoice.line_items.count %> item<%= @invoice.line_items.count != 1 ? 's' : '' %></span>
          </div>
        </div>
        <% if @invoice.line_items.any? %>
          <div class="overflow-x-auto">
            <table class="min-w-full">
              <thead>
                <tr class="bg-slate-50/80">
                  <th class="px-6 py-4 text-left text-xs font-semibold text-slate-500 uppercase tracking-wider">Description</th>
                  <th class="px-6 py-4 text-right text-xs font-semibold text-slate-500 uppercase tracking-wider w-24">Qty</th>
                  <th class="px-6 py-4 text-right text-xs font-semibold text-slate-500 uppercase tracking-wider w-32">Rate</th>
                  <th class="px-6 py-4 text-right text-xs font-semibold text-slate-500 uppercase tracking-wider w-36">Amount</th>
                </tr>
              </thead>
              <tbody class="divide-y divide-slate-100">
                <% @invoice.line_items.each_with_index do |item, index| %>
                  <tr class="<%= index.even? ? 'bg-white' : 'bg-slate-50/30' %> hover:bg-slate-50/60 transition-colors">
                    <td class="px-6 py-4">
                      <p class="text-sm font-medium text-slate-900"><%= item.description %></p>
                    </td>
                    <td class="px-6 py-4 text-right text-sm text-slate-600 font-medium"><%= number_with_precision(item.quantity, precision: 2, strip_insignificant_zeros: true) %></td>
                    <td class="px-6 py-4 text-right text-sm text-slate-600"><%= number_to_currency(item.unit_price) %></td>
                    <td class="px-6 py-4 text-right text-sm font-semibold text-slate-900"><%= number_to_currency(item.amount) %></td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        <% else %>
          <div class="px-6 py-12 text-center">
            <div class="w-16 h-16 mx-auto rounded-full bg-slate-100 flex items-center justify-center mb-4">
              <svg class="w-8 h-8 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
              </svg>
            </div>
            <h3 class="text-sm font-medium text-slate-900">No line items</h3>
            <p class="text-sm text-slate-500 mt-1 mb-4">Add items to this invoice to calculate the total.</p>
            <% if @invoice.draft? %>
              <%= link_to edit_invoice_path(@invoice), data: { turbo_frame: "modal" }, class: "inline-flex items-center px-4 py-2 bg-emerald-600 text-white text-sm font-medium rounded-lg hover:bg-emerald-700 transition-colors" do %>
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                </svg>
                Add Line Items
              <% end %>
            <% end %>
          </div>
        <% end %>
      </div>

      <%# Totals Card %>
      <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
        <div class="px-6 py-4 bg-gradient-to-r from-slate-50 to-slate-100 border-b border-slate-200">
          <div class="flex items-center gap-2">
            <svg class="w-5 h-5 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
            </svg>
            <h2 class="text-base font-semibold text-slate-900">Invoice Summary</h2>
          </div>
        </div>
        <div class="p-6">
          <div class="max-w-sm ml-auto space-y-3">
            <div class="flex justify-between text-sm">
              <span class="text-slate-600">Subtotal</span>
              <span class="font-semibold text-slate-900"><%= number_to_currency(@invoice.subtotal) %></span>
            </div>
            <% if @invoice.tax_rate && @invoice.tax_rate > 0 %>
              <div class="flex justify-between text-sm">
                <span class="text-slate-600">Tax (<%= number_with_precision(@invoice.tax_rate, precision: 2, strip_insignificant_zeros: true) %>%)</span>
                <span class="font-semibold text-slate-900"><%= number_to_currency(@invoice.tax_amount) %></span>
              </div>
            <% end %>
            <% if @invoice.discount_amount && @invoice.discount_amount > 0 %>
              <div class="flex justify-between text-sm">
                <span class="text-slate-600">Discount</span>
                <span class="font-semibold text-emerald-600">-<%= number_to_currency(@invoice.discount_amount) %></span>
              </div>
            <% end %>
            <div class="border-t border-slate-200 pt-3">
              <div class="flex justify-between items-center">
                <span class="text-base font-semibold text-slate-900">Total Due</span>
                <span class="text-2xl font-bold text-slate-900"><%= number_to_currency(@invoice.total_amount) %></span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <%# Notes & Terms %>
      <% if @invoice.notes.present? || @invoice.terms.present? %>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <% if @invoice.notes.present? %>
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
              <div class="px-6 py-4 bg-gradient-to-r from-amber-50 to-yellow-50 border-b border-slate-200">
                <div class="flex items-center gap-2">
                  <svg class="w-5 h-5 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                  </svg>
                  <h2 class="text-base font-semibold text-slate-900">Notes</h2>
                </div>
              </div>
              <div class="p-6">
                <p class="text-sm text-slate-600 whitespace-pre-wrap leading-relaxed"><%= @invoice.notes %></p>
              </div>
            </div>
          <% end %>

          <% if @invoice.terms.present? %>
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
              <div class="px-6 py-4 bg-gradient-to-r from-slate-50 to-slate-100 border-b border-slate-200">
                <div class="flex items-center gap-2">
                  <svg class="w-5 h-5 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                  </svg>
                  <h2 class="text-base font-semibold text-slate-900">Terms & Conditions</h2>
                </div>
              </div>
              <div class="p-6">
                <p class="text-sm text-slate-500 whitespace-pre-wrap leading-relaxed"><%= @invoice.terms %></p>
              </div>
            </div>
          <% end %>
        </div>
      <% end %>

      <%# Payment Info Card (if paid) %>
      <% if @invoice.paid? %>
        <div class="bg-gradient-to-br from-emerald-500 to-teal-600 rounded-xl shadow-lg overflow-hidden text-white p-6">
          <div class="flex items-center gap-4">
            <div class="w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center">
              <svg class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <div class="flex-1">
              <h3 class="text-lg font-bold">Payment Received</h3>
              <p class="text-emerald-100">This invoice has been paid in full</p>
            </div>
            <div class="text-right">
              <p class="text-3xl font-bold"><%= number_to_currency(@invoice.total_amount) %></p>
              <p class="text-emerald-100 text-sm"><%= @invoice.paid_at&.strftime("%B %d, %Y") %></p>
            </div>
          </div>
          <% if @invoice.payment_method.present? || @invoice.payment_reference.present? %>
            <div class="mt-4 pt-4 border-t border-white/20 grid grid-cols-2 gap-4">
              <% if @invoice.payment_method.present? %>
                <div>
                  <p class="text-emerald-100 text-xs uppercase tracking-wide">Payment Method</p>
                  <p class="font-semibold"><%= @invoice.payment_method.humanize %></p>
                </div>
              <% end %>
              <% if @invoice.payment_reference.present? %>
                <div>
                  <p class="text-emerald-100 text-xs uppercase tracking-wide">Reference</p>
                  <p class="font-mono text-sm"><%= @invoice.payment_reference %></p>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>

  <%# Danger Zone %>
  <% if @invoice.draft? || @invoice.cancelled? %>
    <div class="mt-8 bg-red-50 rounded-xl border border-red-200 overflow-hidden">
      <div class="px-6 py-4 bg-gradient-to-r from-red-50 to-rose-50 border-b border-red-200">
        <div class="flex items-center gap-2">
          <svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
          </svg>
          <h2 class="text-base font-semibold text-red-800">Danger Zone</h2>
        </div>
      </div>
      <div class="p-6">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
          <div>
            <h3 class="text-sm font-medium text-red-800">Delete this invoice</h3>
            <p class="text-sm text-red-600 mt-1">Once you delete this invoice, there is no going back. Please be certain.</p>
          </div>
          <%= button_to invoice_path(@invoice), method: :delete, data: { turbo_confirm: "Are you sure you want to delete invoice #{@invoice.invoice_number}? This action cannot be undone." }, class: "inline-flex items-center px-4 py-2 border border-red-300 text-sm font-medium rounded-lg text-red-700 bg-white hover:bg-red-50 transition-colors whitespace-nowrap" do %>
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
            </svg>
            Delete Invoice
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
</div>

<%# Modal container %>
<%= turbo_frame_tag "modal" %>

<%# Print Styles %>
<style>
  @media print {
    .sticky, [data-controller="dropdown"], button, .sm\\:flex, .lg\\:col-span-1 {
      display: none !important;
    }
    .lg\\:col-span-2 {
      grid-column: span 3 !important;
    }
    body {
      background: white !important;
    }
  }
</style>
