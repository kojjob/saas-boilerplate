<% content_for(:title) { "#{@user.full_name} - Admin" } %>

<div class="mb-6">
  <%= link_to "â† Back to Users", admin_users_path, class: "text-indigo-600 hover:text-indigo-500" %>
</div>

<div class="bg-white rounded-lg shadow overflow-hidden">
  <div class="px-6 py-5 border-b border-slate-200 flex justify-between items-center">
    <div class="flex items-center">
      <div class="flex-shrink-0 h-16 w-16 rounded-full bg-indigo-100 flex items-center justify-center">
        <span class="text-indigo-600 font-semibold text-xl"><%= @user.initials %></span>
      </div>
      <div class="ml-4">
        <h1 class="text-2xl font-bold text-slate-900"><%= @user.full_name %></h1>
        <p class="text-slate-500"><%= @user.email %></p>
      </div>
    </div>
    <div class="flex space-x-3">
      <%= link_to "Edit", edit_admin_user_path(@user), class: "inline-flex items-center px-4 py-2 border border-slate-300 rounded-md shadow-sm text-sm font-medium text-slate-700 bg-white hover:bg-slate-50" %>
      <% unless @user == current_user %>
        <%= button_to "Impersonate", impersonate_admin_user_path(@user), method: :post, class: "inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-amber-600 hover:bg-amber-700" %>
        <%= button_to "Delete", admin_user_path(@user), method: :delete, data: { turbo_confirm: "Are you sure you want to delete this user?" }, class: "inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700" %>
      <% end %>
    </div>
  </div>

  <div class="px-6 py-5">
    <dl class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
      <div>
        <dt class="text-sm font-medium text-slate-500">First Name</dt>
        <dd class="mt-1 text-sm text-slate-900"><%= @user.first_name %></dd>
      </div>
      <div>
        <dt class="text-sm font-medium text-slate-500">Last Name</dt>
        <dd class="mt-1 text-sm text-slate-900"><%= @user.last_name %></dd>
      </div>
      <div>
        <dt class="text-sm font-medium text-slate-500">Email</dt>
        <dd class="mt-1 text-sm text-slate-900"><%= @user.email %></dd>
      </div>
      <div>
        <dt class="text-sm font-medium text-slate-500">Status</dt>
        <dd class="mt-1">
          <% if @user.confirmed? %>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">Confirmed</span>
          <% else %>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-amber-100 text-amber-800">Pending Confirmation</span>
          <% end %>
        </dd>
      </div>
      <div>
        <dt class="text-sm font-medium text-slate-500">Site Admin</dt>
        <dd class="mt-1">
          <% if @user.site_admin? %>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800">Yes</span>
          <% else %>
            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800">No</span>
          <% end %>
        </dd>
      </div>
      <div>
        <dt class="text-sm font-medium text-slate-500">Created</dt>
        <dd class="mt-1 text-sm text-slate-900"><%= @user.created_at.strftime("%B %d, %Y at %I:%M %p") %></dd>
      </div>
    </dl>
  </div>
</div>

<%# Account Memberships %>
<div class="mt-6 bg-white rounded-lg shadow overflow-hidden">
  <div class="px-6 py-4 border-b border-slate-200">
    <h2 class="text-lg font-semibold text-slate-900">Account Memberships</h2>
  </div>
  <% if @user.memberships.any? %>
    <table class="min-w-full divide-y divide-slate-200">
      <thead class="bg-slate-50">
        <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Account</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Role</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Joined</th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-slate-200">
        <% @user.memberships.includes(:account).each do |membership| %>
          <tr>
            <td class="px-6 py-4 whitespace-nowrap">
              <%= link_to membership.account.name, admin_account_path(membership.account), class: "text-indigo-600 hover:text-indigo-500" %>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <span class="capitalize"><%= membership.role %></span>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-500">
              <%= membership.created_at.strftime("%b %d, %Y") %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% else %>
    <p class="px-6 py-4 text-slate-500">No account memberships.</p>
  <% end %>
</div>
