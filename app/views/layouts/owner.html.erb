<!DOCTYPE html>
<html class="h-full">
  <head>
    <title><%= content_for(:title) || "Owner Portal - Deployable" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="robots" content="noindex, nofollow">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <link rel="icon" href="/icon.png" type="image/png">
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body class="min-h-full flex flex-col bg-slate-900 text-white antialiased">
    <%# Owner Portal Navigation %>
    <nav class="bg-indigo-900" data-controller="mobile-menu">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <%# Desktop & Tablet Navigation %>
        <div class="flex items-center justify-between h-16">
          <%# Left side - Logo & Nav Links %>
          <div class="flex items-center">
            <%# Mobile menu button %>
            <button type="button"
                    class="md:hidden inline-flex items-center justify-center p-2 -ml-2 mr-2 rounded-lg text-indigo-200 hover:text-white hover:bg-indigo-800 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white"
                    data-action="click->mobile-menu#toggle"
                    aria-expanded="false">
              <span class="sr-only">Open main menu</span>
              <%# Hamburger icon %>
              <svg data-mobile-menu-target="openIcon" class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
              </svg>
              <%# Close icon %>
              <svg data-mobile-menu-target="closeIcon" class="hidden h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>

            <%= link_to owner_root_path, class: "flex items-center gap-2 text-lg sm:text-xl font-bold text-white" do %>
              <span class="hidden xs:inline">Owner</span>
              <span>Portal</span>
            <% end %>

            <%# Desktop nav links %>
            <div class="hidden md:block ml-8 lg:ml-10">
              <div class="flex items-baseline space-x-1 lg:space-x-2">
                <%= link_to "Dashboard", owner_root_path, class: "px-3 py-2 rounded-lg text-sm font-medium transition-colors hover:bg-indigo-800 #{request.path == owner_root_path ? 'bg-indigo-800 text-white' : 'text-indigo-100'}" %>
                <%= link_to "Accounts", owner_accounts_path, class: "px-3 py-2 rounded-lg text-sm font-medium transition-colors hover:bg-indigo-800 #{request.path.start_with?('/owner/accounts') ? 'bg-indigo-800 text-white' : 'text-indigo-100'}" %>
                <%= link_to "Reports", owner_reports_path, class: "px-3 py-2 rounded-lg text-sm font-medium transition-colors hover:bg-indigo-800 #{request.path.start_with?('/owner/reports') ? 'bg-indigo-800 text-white' : 'text-indigo-100'}" %>
              </div>
            </div>
          </div>

          <%# Right side - User info & actions %>
          <div class="flex items-center gap-2 sm:gap-3">
            <%# User email - hidden on small mobile %>
            <span class="hidden lg:block text-sm text-indigo-200 truncate max-w-[200px]"><%= current_user.email %></span>

            <%# Back to App button %>
            <%= link_to dashboard_path, class: "inline-flex items-center gap-1.5 px-3 py-2 rounded-lg text-sm font-medium bg-indigo-600 hover:bg-indigo-700 text-white transition-colors min-h-[44px]" do %>
              <svg class="w-4 h-4 hidden sm:block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
              </svg>
              <span class="hidden sm:inline">Back to App</span>
              <span class="sm:hidden">App</span>
            <% end %>

            <%# Sign out button - icon only on mobile %>
            <%= button_to sign_out_path, method: :delete, class: "inline-flex items-center justify-center gap-1.5 px-3 py-2 rounded-lg text-sm font-medium text-indigo-100 hover:bg-indigo-800 transition-colors min-h-[44px]" do %>
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
              </svg>
              <span class="hidden sm:inline">Sign Out</span>
            <% end %>
          </div>
        </div>

        <%# Mobile Navigation Menu %>
        <div data-mobile-menu-target="menu" class="hidden md:hidden border-t border-indigo-800">
          <div class="py-3 space-y-1">
            <%= link_to "Dashboard", owner_root_path, class: "block px-4 py-3 rounded-lg text-base font-medium transition-colors min-h-[48px] flex items-center #{request.path == owner_root_path ? 'bg-indigo-800 text-white' : 'text-indigo-100 hover:bg-indigo-800'}" %>
            <%= link_to "Accounts", owner_accounts_path, class: "block px-4 py-3 rounded-lg text-base font-medium transition-colors min-h-[48px] flex items-center #{request.path.start_with?('/owner/accounts') ? 'bg-indigo-800 text-white' : 'text-indigo-100 hover:bg-indigo-800'}" %>
            <%= link_to "Reports", owner_reports_path, class: "block px-4 py-3 rounded-lg text-base font-medium transition-colors min-h-[48px] flex items-center #{request.path.start_with?('/owner/reports') ? 'bg-indigo-800 text-white' : 'text-indigo-100 hover:bg-indigo-800'}" %>
          </div>
          <%# User info on mobile %>
          <div class="py-3 border-t border-indigo-800">
            <div class="px-4 py-2 text-sm text-indigo-300">
              Signed in as <span class="font-medium text-white"><%= current_user.email %></span>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <%# Flash messages %>
    <%= render "shared/flash" %>

    <%# Main content area %>
    <main id="main-content" class="flex-1 py-6">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <%= yield %>
      </div>
    </main>

    <%# Footer %>
    <footer class="bg-indigo-900 text-indigo-300 py-4">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-sm">
        Owner Portal &copy; <%= Date.current.year %> - Site Administration
      </div>
    </footer>
  </body>
</html>
