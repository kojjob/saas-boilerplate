<%= form_with model: time_entry, class: "space-y-5" do |f| %>
  <% if time_entry.errors.any? %>
    <div class="rounded-lg bg-red-50 p-4 text-sm text-red-700">
      <ul class="list-disc pl-5 space-y-1">
        <% time_entry.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%# Project & Date Section %>
  <div class="space-y-4">
    <h3 class="text-sm font-medium text-gray-900">Time details</h3>

    <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">Project</label>
      <%= f.collection_select :project_id, @projects, :id, :name,
          { prompt: "Select a project" },
          class: "w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white" %>
    </div>

    <div class="grid grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Date</label>
        <%= f.date_field :date,
            class: "w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent" %>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Hours</label>
        <%= f.number_field :hours,
            step: 0.25,
            min: 0,
            max: 24,
            class: "w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",
            placeholder: "0.00" %>
      </div>
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">Description <span class="text-gray-400 font-normal">(optional)</span></label>
      <%= f.text_area :description,
          rows: 3,
          class: "w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none",
          placeholder: "What did you work on?" %>
    </div>
  </div>

  <%# Billing Section %>
  <div class="space-y-4 pt-4 border-t border-gray-100">
    <h3 class="text-sm font-medium text-gray-900">Billing</h3>

    <div class="flex items-center gap-3">
      <%= f.check_box :billable,
          class: "h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded" %>
      <label class="text-sm text-gray-700">
        This time is billable
      </label>
    </div>

    <div>
      <label class="block text-sm font-medium text-gray-700 mb-2">Hourly rate <span class="text-gray-400 font-normal">(optional, overrides project rate)</span></label>
      <div class="relative">
        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
          <span class="text-gray-400 text-sm">$</span>
        </div>
        <%= f.number_field :hourly_rate,
            step: 0.01,
            min: 0,
            class: "w-full pl-7 pr-12 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",
            placeholder: "0.00" %>
        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
          <span class="text-gray-400 text-sm">/hr</span>
        </div>
      </div>
      <p class="mt-1 text-xs text-gray-500">Leave blank to use the project's hourly rate</p>
    </div>
  </div>

  <%# Footer with actions %>
  <div class="flex items-center justify-end gap-3 pt-4 border-t border-gray-100">
    <button type="button"
            data-action="modal#close"
            class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
      Cancel
    </button>
    <%= f.submit time_entry.persisted? ? "Save changes" : "Log time",
        class: "px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors cursor-pointer" %>
  </div>
<% end %>
